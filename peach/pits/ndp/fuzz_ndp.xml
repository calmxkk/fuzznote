<?xml version="1.0" encoding="utf-8"?>
<Peach>

    <Include ns="ndp" src="file:./ndp_state.xml" />

    <Defaults>
        <Number endian="big" />
    </Defaults>

    <!-- Monitor -->
    <Agent name="TheAgent">
        <Monitor class="RunCommand">
            <Param name="Command" value="python" />
            <Param name="Arguments" value="./monitor.py" />
            <Param name="FaultOnNonZeroExit" value="true" />
            <Param name="When" value="OnIterationEnd" />
        </Monitor>
    </Agent>

    <!-- 设置maxOutputSize以防止产生过大数据包 -->
    <Test name="Default" maxOutputSize="10000">
        <!-- 变异策略 -->
        <Strategy class="Random">
            <Param name="MaxFieldsToMutate" value="6" />
            <Param name="SwitchCount" value="200" />
        </Strategy>

        <!-- 指定要使用的状态模型 -->
        <StateModel ref="ndp:State" />

        <!-- 指定Publisher -->
        <Publisher class="RawV6">
            <Param name="Host" value="##HOST##" />
            <Param name="Protocol" value="58" />
        </Publisher>

        <Agent ref="TheAgent" />

        <Logger class="File">
            <Param name="Path" value="##PATHLOG##" />
        </Logger>
    </Test>
</Peach>